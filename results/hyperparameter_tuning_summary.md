# 随机森林超参数调优总结报告

## 超参数调优过程

本次超参数调优实验针对随机森林模型进行了全面的参数搜索和优化。主要包括以下几个关键步骤：

1. **网格搜索参数优化**：
   - 使用网格搜索方法在大规模参数空间中进行探索
   - 参数网格包含5760种不同组合，涵盖了树数量、深度、分裂标准等关键参数
   - 使用5折交叉验证评估每组参数的性能
   - 优化目标为负平均绝对误差(neg_mean_absolute_error)
   - 搜索耗时约1小时01分35秒

2. **集成学习方法评估**：
   - 基于网格搜索结果，实现并评估了堆叠集成模型
   - 使用不同配置的随机森林作为基础模型
   - 采用线性回归作为元模型

## 主要实验结果

### 网格搜索发现的最佳参数

| 参数              | 最佳值           |
|-------------------|-----------------|
| n_estimators      | 100             |
| max_depth         | 25              |
| min_samples_split | 2               |
| min_samples_leaf  | 1               |
| max_features      | sqrt            |
| criterion         | squared_error   |
| bootstrap         | True            |

### 不同模型配置的性能对比

| 模型类型                   | MAE    | RMSE    | R²     |
|---------------------------|--------|---------|--------|
| 之前的标准随机森林          | 20.557 | 24.718  | 0.6197 |
| 之前的集成随机森林          | 19.054 | 22.884  | 0.6741 |
| 网格搜索优化随机森林        | 20.839 | 24.818  | 0.6166 |
| 最新集成随机森林(调整参数后) | 21.650 | 25.538  | 0.5941 |

## 性能分析与发现

1. **模型过拟合严重**：
   - 所有模型在训练集上的性能都远高于测试集
   - 网格搜索优化模型在训练集上R²达到0.9963，但测试集仅0.6166

2. **集成学习效果不稳定**：
   - 之前的集成模型显示了最好的结果(MAE=19.054)
   - 使用网格搜索最优参数后的集成模型反而性能下降(MAE=21.65)
   - 这表明简单参数组合可能并不能直接转化为更好的集成效果

3. **参数影响分析**：
   - 较小的树数量(n_estimators=100)与适中的树深度(max_depth=25)在单模型上表现最好
   - 默认的分裂参数(min_samples_split=2, min_samples_leaf=1)优于更严格的限制条件
   - 使用"squared_error"作为分裂标准优于其他选项

4. **关键发现**：
   - 参数优化并未显著提高模型泛化能力
   - 训练集与测试集之间可能存在分布偏移
   - 当前特征集可能不足以捕捉复杂的工具磨损模式

## 改进建议

1. **特征工程增强**：
   - 探索更多领域相关特征，特别是与工具磨损物理机制相关的特征
   - 考虑添加时序特征，如滑动窗口统计量、变化率等
   - 实现小波包分解或经验模态分解提取更多频率域信息

2. **数据处理策略**：
   - 采用更复杂的数据归一化方法，如分段归一化或分位数变换
   - 利用领域知识对异常值进行处理
   - 考虑合成数据增强训练集多样性

3. **高级模型考虑**：
   - 尝试梯度提升树模型(XGBoost, LightGBM)，它们通常在结构化数据上表现优异
   - 考虑深度学习模型如LSTM或1D-CNN捕捉时间序列特征
   - 探索多模态学习，整合多种传感器数据

4. **集成策略优化**：
   - 使用异构模型的集成，而不仅是同一模型的不同参数
   - 实现更复杂的堆叠策略，使用二级堆叠或特征增强堆叠
   - 优化集成模型的权重分配

5. **交叉验证改进**：
   - 采用留一实验交叉验证(Leave-One-Experiment-Out)更好评估泛化能力
   - 实现时间序列交叉验证，考虑数据的时间依赖性
   - 使用嵌套交叉验证评估超参数优化的有效性

## 结论

本次超参数优化实验表明，仅靠参数调整难以解决随机森林模型在工具磨损预测任务上的泛化性能问题。改进的关键在于特征工程、数据处理和模型架构的创新。建议未来的研究从多个维度同时入手，特别是增强特征的表达能力，以及考虑更适合捕捉时间序列模式的模型结构。 